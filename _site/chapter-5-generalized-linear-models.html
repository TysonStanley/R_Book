<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5: Generalized Linear Models | 05-GLMs.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5: Generalized Linear Models | 05-GLMs.knit" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5: Generalized Linear Models | 05-GLMs.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="site_libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="site_libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="site_libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="site_libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="site_libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="site_libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="site_libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="site_libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path=""><a href="#chapter-5-generalized-linear-models"><i class="fa fa-check"></i>Chapter 5: Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#logistic-regression"><i class="fa fa-check"></i>Logistic Regression</a></li>
<li class="chapter" data-level="" data-path=""><a href="#poisson-regression"><i class="fa fa-check"></i>Poisson Regression</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#gamma"><i class="fa fa-check"></i>Gamma</a></li>
<li class="chapter" data-level="" data-path=""><a href="#two-part-or-hurdle-models"><i class="fa fa-check"></i>Two-Part or Hurdle Models</a></li>
<li class="chapter" data-level="" data-path=""><a href="#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#beta-regression"><i class="fa fa-check"></i>Beta Regression</a></li>
<li class="chapter" data-level="" data-path=""><a href="#apply-it"><i class="fa fa-check"></i>Apply It</a>
<ul>
<li class="chapter" data-level="" data-path=""><a href="#step-1"><i class="fa fa-check"></i>Step 1</a></li>
<li class="chapter" data-level="" data-path=""><a href="#step-2"><i class="fa fa-check"></i>Step 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#conclusions"><i class="fa fa-check"></i>Conclusions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="chapter-5-generalized-linear-models" class="section level1 unnumbered">
<h1>Chapter 5: Generalized Linear Models</h1>
<blockquote>
<p>“You must stick to your conviction, but be ready to abandon your assumptions.” — Dennis Waitley</p>
</blockquote>
<p>Generalized Linear Models (GLM’s) are extensions of linear regression to areas where assumptions of normality and homoskedasticity do not hold. There are several versions of GLM’s, each for different types and distributions of outcomes. We are going to go through several of the most common.</p>
<p>This chapter is to introduce the method very briefly and demonstrate how to perform one in <code>R</code>. We do not delve into the details of each method much, but rather focus on showing the quirks of the coding.</p>
<p>We discuss:</p>
<ol style="list-style-type: decimal">
<li>Logistic Regression</li>
<li>Poisson Regression</li>
<li>GLM with Gamma distribution</li>
<li>Negative binomial</li>
<li>Beta Regression</li>
</ol>
<div id="logistic-regression" class="section level2 unnumbered">
<h2>Logistic Regression</h2>
<p>For binary outcomes (e.g., yes or no, correct or incorrect, sick or healthy), logistic regression is a fantastic tool that provides useful and interpretable information. Much like simple and multiple linear regression, logistic regression<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> uses dummy coding and provides coefficients that tell us the relationship between the outcome and the independent variables.</p>
<p>Since the outcome is binary, we use a statistical transformation to make things work well. This makes it so the outcome is in “log-odds.” A simple exponentiation of the coefficients and we get very useful “odds ratios.” These are very common in many fields using binary data.</p>
<p>Luckily, running a logistic regression is simple in <code>R</code>. We first create the binary outcome variable called <code>dep</code>. We use a new function called <code>mutate</code> to create a new variable (we could do this a number of ways but this is probably the cleanest way).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## First creating binary depression variable</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dep =</span> dpq010 <span class="sc">+</span> dpq020 <span class="sc">+</span> dpq030 <span class="sc">+</span> dpq040 <span class="sc">+</span> dpq050 <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               dpq060 <span class="sc">+</span> dpq070 <span class="sc">+</span> dpq080 <span class="sc">+</span> dpq090) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dep2 =</span> <span class="fu">ifelse</span>(dep <span class="sc">&gt;=</span> <span class="dv">10</span>, <span class="dv">1</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ifelse</span>(dep <span class="sc">&lt;</span> <span class="dv">10</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span></code></pre></div>
<p>Note that we added the values from the ten variables that give us an overall depression score (<code>dep</code>). We then use <code>ifelse()</code> to create a binary version of depression called <code>dep2</code> with a cutoff of <span class="math inline">\(\geq 16\)</span> meaning depressed. Because there are missing values denoted as “NA” in this variable, we use a “nested ifelse” to say:</p>
<ol style="list-style-type: decimal">
<li>IF depression <span class="math inline">\(\geq 10\)</span> then dep2 is 1,</li>
<li>IF dpression <span class="math inline">\(&lt; 10\)</span>, then dep2 is 0,</li>
<li>ELSE dep2 is NA.</li>
</ol>
<p>Note that these nested <code>ifelse()</code> statements can be as long as you want. We further need to clean up the asthma and sedentary variables.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fix some placeholders</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">asthma =</span> <span class="fu">washer</span>(mcq010, <span class="dv">9</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">asthma =</span> <span class="fu">washer</span>(asthma, <span class="dv">2</span>, <span class="at">value =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sed =</span> <span class="fu">washer</span>(pad680, <span class="dv">9999</span>, <span class="dv">7777</span>))</span></code></pre></div>
<p>Now let’s run the logistic regression:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>l_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(dep2 <span class="sc">~</span> asthma <span class="sc">+</span> sed <span class="sc">+</span> race <span class="sc">+</span> famsize,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> df,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(l_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = dep2 ~ asthma + sed + race + famsize, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.7831  -0.4479  -0.4078  -0.3645   2.5471  
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -2.6203555  0.2380770 -11.006  &lt; 2e-16 ***
## asthma             0.5688452  0.1276326   4.457 8.32e-06 ***
## sed                0.0005638  0.0002610   2.160   0.0307 *  
## raceOtherHispanic  0.7162568  0.2328673   3.076   0.0021 ** 
## raceWhite          0.1287059  0.2116414   0.608   0.5431    
## raceBlack          0.0189205  0.2205461   0.086   0.9316    
## raceOther         -0.4901414  0.2570123  -1.907   0.0565 .  
## famsize           -0.0318309  0.0373218  -0.853   0.3937    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2706.3  on 4436  degrees of freedom
## Residual deviance: 2648.2  on 4429  degrees of freedom
##   (195 observations deleted due to missingness)
## AIC: 2664.2
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>We used <code>glm()</code> (stands for generalized linear model). The key to making it logistic, since you can use <code>glm()</code> for a linear model using maximum likelihood instead of <code>lm()</code> with least squares, is <code>family = "binomial"</code>. This tells <code>R</code> to do a logistic regression.</p>
</div>
<div id="poisson-regression" class="section level2 unnumbered">
<h2>Poisson Regression</h2>
<p>As we did in logistic regression, we will use the <code>glm()</code> function. The difference here is we will be using an outcome that is a count variable. For example, the sedentary variable (<code>sed</code>) that we have in <code>df</code> is a count of the minutes of sedentary activity.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(sed <span class="sc">~</span> asthma <span class="sc">+</span> race <span class="sc">+</span> famsize,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> df,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(p_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = sed ~ asthma + race + famsize, family = &quot;poisson&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -27.362   -8.430   -1.477    5.823   34.507  
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        5.6499871  0.0035550 1589.31   &lt;2e-16 ***
## asthma             0.0614965  0.0021434   28.69   &lt;2e-16 ***
## raceOtherHispanic  0.1393438  0.0040940   34.04   &lt;2e-16 ***
## raceWhite          0.3484622  0.0033438  104.21   &lt;2e-16 ***
## raceBlack          0.3400346  0.0034430   98.76   &lt;2e-16 ***
## raceOther          0.3557953  0.0036273   98.09   &lt;2e-16 ***
## famsize           -0.0188673  0.0005488  -34.38   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 496351  on 4436  degrees of freedom
## Residual deviance: 475428  on 4430  degrees of freedom
##   (195 observations deleted due to missingness)
## AIC: 508999
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Sedentary may be over-dispersed (see plot)
<img src="05-GLMs_files/figure-html/unnamed-chunk-6-1.png" width="672" />
and so other methods related to poisson may be necessary. For this book, we are not going to be delving into these in depth but we will introduce some below.</p>
<div id="gamma" class="section level3 unnumbered">
<h3>Gamma</h3>
<p>Regression with a gamma distribution are often found when analyzing costs in dollars. It is very similar to poisson but does not require integers and can handle more dispersion. However, the outcome must have values <span class="math inline">\(&gt; 0\)</span>. Just for demonstration:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjust sed</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sed_gamma <span class="ot">&lt;-</span> df<span class="sc">$</span>sed <span class="sc">+</span> .<span class="dv">01</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>g_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(sed_gamma <span class="sc">~</span> asthma <span class="sc">+</span> race <span class="sc">+</span> famsize,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> df,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="st">&quot;Gamma&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(g_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = sed_gamma ~ asthma + race + famsize, family = &quot;Gamma&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.3589  -0.4613  -0.0845   0.2926   1.6868  
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        3.567e-03  1.132e-04  31.515  &lt; 2e-16 ***
## asthma            -1.604e-04  5.865e-05  -2.735  0.00626 ** 
## raceOtherHispanic -4.874e-04  1.309e-04  -3.723  0.00020 ***
## raceWhite         -1.090e-03  1.078e-04 -10.115  &lt; 2e-16 ***
## raceBlack         -1.068e-03  1.102e-04  -9.697  &lt; 2e-16 ***
## raceOther         -1.110e-03  1.145e-04  -9.695  &lt; 2e-16 ***
## famsize            5.107e-05  1.552e-05   3.289  0.00101 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.2932604)
## 
##     Null deviance: 1664.8  on 4436  degrees of freedom
## Residual deviance: 1604.2  on 4430  degrees of freedom
##   (195 observations deleted due to missingness)
## AIC: 59154
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="two-part-or-hurdle-models" class="section level3 unnumbered">
<h3>Two-Part or Hurdle Models</h3>
<p>We are going to use the <code>pscl</code> package to run a hurdle model. These models are built for situations where there is a count variable with many zeros (“zero-inflated”). The hurdle model makes slightly different assumptions regarding the zeros than the pure negative binomial that we present next. The hurdle consists of two models: one for whether the person had a zero or more (binomial) and if more than zero, how many (poisson).</p>
<p>To run a hurdle model, we are going to make a sedentary variable with many more zeros to illustrate and then we will run a hurdle model.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Zero inflated sedentary (don&#39;t worry too much about the specifics)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>sed_zero <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="fu">length</span>(df<span class="sc">$</span>sed), </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">20</span><span class="sc">:</span><span class="dv">25</span>), <span class="dv">0</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                      df<span class="sc">$</span>sed)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Hurdle model</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>h_fit <span class="ot">=</span> <span class="fu">hurdle</span>(sed_zero <span class="sc">~</span> asthma <span class="sc">+</span> race <span class="sc">+</span> famsize,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(h_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## hurdle(formula = sed_zero ~ asthma + race + famsize, data = df)
## 
## Pearson residuals:
##    Min     1Q Median     3Q    Max 
## -4.064 -1.420 -0.287  1.279 11.936 
## 
## Count model coefficients (truncated poisson with log link):
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        5.6468008  0.0036936 1528.81   &lt;2e-16 ***
## asthma             0.0514669  0.0022782   22.59   &lt;2e-16 ***
## raceOtherHispanic  0.1228595  0.0042682   28.79   &lt;2e-16 ***
## raceWhite          0.3512232  0.0034639  101.39   &lt;2e-16 ***
## raceBlack          0.3449748  0.0035595   96.92   &lt;2e-16 ***
## raceOther          0.3604698  0.0037536   96.03   &lt;2e-16 ***
## famsize           -0.0187346  0.0005791  -32.35   &lt;2e-16 ***
## Zero hurdle model coefficients (binomial with logit link):
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        2.877930   0.250810  11.475   &lt;2e-16 ***
## asthma            -0.231183   0.138205  -1.673   0.0944 .  
## raceOtherHispanic -0.453694   0.277816  -1.633   0.1025    
## raceWhite         -0.722182   0.234769  -3.076   0.0021 ** 
## raceBlack         -0.358572   0.246228  -1.456   0.1453    
## raceOther         -0.388724   0.259680  -1.497   0.1344    
## famsize           -0.008691   0.036785  -0.236   0.8132    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Number of iterations in BFGS optimization: 12 
## Log-likelihood: -2.339e+05 on 14 Df</code></pre>
<p>Notice that the output has two parts: “Count model coefficients (truncated poisson with log link):” and “Zero hurdle model coefficients (binomial with logit link):”. Together they tell us about the relationship between the predictors and a count variable with many zeros.</p>
</div>
<div id="negative-binomial" class="section level3 unnumbered">
<h3>Negative Binomial</h3>
<p>Similar to that above, negative binomial is for zero-inflated count variables. It makes slightly different assumptions than the hurdle and doesn’t use a two-part approach. In order to run a negative binomial model we’ll use the <code>MASS</code> package and the <code>glm.nb()</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fit_nb <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(sed_zero <span class="sc">~</span> asthma <span class="sc">+</span> race <span class="sc">+</span> famsize,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_nb)</span></code></pre></div>
<p>Note that this model is not really appropriate because our data is somewhat contrived.</p>
</div>
</div>
<div id="beta-regression" class="section level2 unnumbered">
<h2>Beta Regression</h2>
<p>For outcomes that are bound between a lower and upper bound, Beta Regression is a great method. For example, if we are looking at test scores that are bound between 0 and 100. It is a very flexible method and allows for some extra analysis regarding the variation.</p>
<p>For this, we are going to use the <code>betareg</code> package. But first, we are going to reach a little and create a ficticiously bound variable in the data set.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable bound between 0 and 1</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>beta_var <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(.<span class="dv">05</span>, .<span class="dv">99</span>, <span class="at">by =</span> .<span class="dv">01</span>), </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="fu">length</span>(df<span class="sc">$</span>asthma),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>fit_beta <span class="ot">&lt;-</span> <span class="fu">betareg</span>(beta_var <span class="sc">~</span> asthma <span class="sc">+</span> race <span class="sc">+</span> famsize,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_beta)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = beta_var ~ asthma + race + famsize, data = df)
## 
## Standardized weighted residuals 2:
##     Min      1Q  Median      3Q     Max 
## -2.0360 -0.6942 -0.0568  0.6252  2.8708 
## 
## Coefficients (mean model with logit link):
##                    Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)        0.075683   0.063595   1.190    0.234
## asthma             0.048428   0.043959   1.102    0.271
## raceOtherHispanic  0.062856   0.072407   0.868    0.385
## raceWhite          0.043366   0.059064   0.734    0.463
## raceBlack          0.004511   0.061316   0.074    0.941
## raceOther          0.080141   0.065729   1.219    0.223
## famsize           -0.008305   0.010882  -0.763    0.445
## 
## Phi coefficients (precision model with identity link):
##       Estimate Std. Error z value Pr(&gt;|z|)    
## (phi)  2.42433    0.04405   55.04   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 70.15 on 8 Df
## Pseudo R-squared: 0.001127
## Number of iterations: 15 (BFGS) + 1 (Fisher scoring)</code></pre>
<p>The output provides coefficients and the “Phi” coefficients. Both are important parts of using beta regression but we are not going to discuss it here.</p>
<p>There are many resources available to learn more about beta regression and each of these GLM’s. As for now, we are going to move on to more complex modeling where there are clustering or repeated measures in the data.</p>
</div>
<div id="apply-it" class="section level2 unnumbered">
<h2>Apply It</h2>
<p><a href="https://tysonbarrett.com/DataR/Chapter4.zip">This link</a> contains a folder complete with an Rstudio project file, an RMarkdown file, and a few data files. Download it and unzip it to do the following steps.</p>
<div id="step-1" class="section level3 unnumbered">
<h3>Step 1</h3>
<p>Open the <code>Chapter4.Rproj</code> file. This will open up RStudio for you.</p>
</div>
<div id="step-2" class="section level3 unnumbered">
<h3>Step 2</h3>
<p>Once RStudio has started, in the panel on the lower-right, there is a <code>Files</code> tab. Click on that to see the project folder. You should see the data files and the <code>Chapter4.Rmd</code> file. Click on the <code>Chapter4.Rmd</code> file to open it. In this file, import the data and run each type of statistical analysis presented in this chapter (there are others that are presented in Chapter 4—that you may have done already—and Chapters 6 and 7 that you do not need to do yet).</p>
<p>Once that code is in the file, click the <code>knit</code> button. This will create an HTML file with the code and output knitted together into one nice document. This can be read into any browser and can be used to show your work in a clean document.</p>
</div>
</div>
<div id="conclusions" class="section level2 unnumbered">
<h2>Conclusions</h2>
<p>One of the great things about <code>R</code> is that most modeling is very similar to the basic <code>lm()</code> function. In all of these GLM’s the arguments are nearly all the same: a formula, the data, and family of model. As you’ll see for Multilevel and Other Models chapters, this does not change much. Having a good start with basic models and GLM’s gets you ready for nearly every other modeling type in <code>R</code>.</p>
</div>
</div>






<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Technically, logistic regression is a linear regression model.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="site_libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="site_libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="site_libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="site_libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="site_libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="site_libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="site_libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="site_libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
