<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Rstats for Researchers</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Rstats for Researchers">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Rstats for Researchers" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Rstats for Researchers" />
  
  
  

<meta name="author" content="Tyson S. Barrett">


<meta name="date" content="2017-01-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chapter-4-basic-analyses.html">
<link rel="next" href="chapter-6-multilevel-modeling.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#part-i"><i class="fa fa-check"></i>Part I</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#part-ii"><i class="fa fa-check"></i>Part II</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#part-iii"><i class="fa fa-check"></i>Part III</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#download-r-and-rstudio"><i class="fa fa-check"></i>Download R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html"><i class="fa fa-check"></i>Chapter 1: The Basics</a><ul>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#objects-data-types-and-functions"><i class="fa fa-check"></i>Objects, Data Types and Functions</a><ul>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#objects"><i class="fa fa-check"></i>Objects</a></li>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#data-types"><i class="fa fa-check"></i>Data Types</a></li>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#functions"><i class="fa fa-check"></i>Functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#importing-data"><i class="fa fa-check"></i>Importing Data</a><ul>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#delimited-files"><i class="fa fa-check"></i>Delimited Files</a></li>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#other-data-formats"><i class="fa fa-check"></i>Other Data Formats</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#saving-data"><i class="fa fa-check"></i>Saving Data</a></li>
<li class="chapter" data-level="" data-path="chapter-1-the-basics.html"><a href="chapter-1-the-basics.html#conclusions"><i class="fa fa-check"></i>Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html"><i class="fa fa-check"></i>Chapter 2: Manipulating Your Data</a><ul>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#tidy-methods"><i class="fa fa-check"></i>Tidy Methods</a></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#piping"><i class="fa fa-check"></i>Piping</a></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#select-and-filter"><i class="fa fa-check"></i>Select and Filter</a></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#grouping-and-summarizing"><i class="fa fa-check"></i>Grouping and Summarizing</a></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#reshaping"><i class="fa fa-check"></i>Reshaping</a><ul>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#wide-form"><i class="fa fa-check"></i>Wide Form</a></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#long-form"><i class="fa fa-check"></i>Long Form</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#joining-merging"><i class="fa fa-check"></i>Joining (merging)</a><ul>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#inner-join"><i class="fa fa-check"></i>Inner Join</a></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#left-or-right-join"><i class="fa fa-check"></i>Left or Right Join</a></li>
<li class="chapter" data-level="" data-path="chapter-2-manipulating-your-data.html"><a href="chapter-2-manipulating-your-data.html#full-join"><i class="fa fa-check"></i>Full Join</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-3-understanding-and-describing-your-data.html"><a href="chapter-3-understanding-and-describing-your-data.html"><i class="fa fa-check"></i>Chapter 3: Understanding and Describing Your Data</a><ul>
<li class="chapter" data-level="" data-path="chapter-3-understanding-and-describing-your-data.html"><a href="chapter-3-understanding-and-describing-your-data.html#descriptive-statistics"><i class="fa fa-check"></i>Descriptive Statistics</a></li>
<li class="chapter" data-level="" data-path="chapter-3-understanding-and-describing-your-data.html"><a href="chapter-3-understanding-and-describing-your-data.html#visualizations"><i class="fa fa-check"></i>Visualizations</a><ul>
<li class="chapter" data-level="0.0.1" data-path="chapter-3-understanding-and-describing-your-data.html"><a href="chapter-3-understanding-and-describing-your-data.html#using-ggplot2"><i class="fa fa-check"></i><b>0.0.1</b> Using <code class="unnumbered">ggplot2</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html"><i class="fa fa-check"></i>Chapter 4: Basic Analyses</a><ul>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#anova"><i class="fa fa-check"></i>ANOVA</a><ul>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#assumptions"><i class="fa fa-check"></i>Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#linear-modeling"><i class="fa fa-check"></i>Linear Modeling</a><ul>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#assumptions-1"><i class="fa fa-check"></i>Assumptions</a></li>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#comparing-models"><i class="fa fa-check"></i>Comparing Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#when-assumptions-fail"><i class="fa fa-check"></i>When Assumptions Fail</a><ul>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#log-linear-log-log-linear-log-other"><i class="fa fa-check"></i>Log-Linear, Log-Log, Linear-Log, Other</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#interactions"><i class="fa fa-check"></i>Interactions</a><ul>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#interactions-in-anova"><i class="fa fa-check"></i>Interactions in ANOVA</a></li>
<li class="chapter" data-level="" data-path="chapter-4-basic-analyses.html"><a href="chapter-4-basic-analyses.html#interactions-in-linear-regression"><i class="fa fa-check"></i>Interactions in Linear Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5-generalized-linear-models.html"><a href="chapter-5-generalized-linear-models.html"><i class="fa fa-check"></i>Chapter 5: Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="chapter-5-generalized-linear-models.html"><a href="chapter-5-generalized-linear-models.html#logistic-regression"><i class="fa fa-check"></i>Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="chapter-5-generalized-linear-models.html"><a href="chapter-5-generalized-linear-models.html#poisson-regression"><i class="fa fa-check"></i>Poisson Regression</a><ul>
<li class="chapter" data-level="" data-path="chapter-5-generalized-linear-models.html"><a href="chapter-5-generalized-linear-models.html#gamma"><i class="fa fa-check"></i>Gamma</a></li>
<li class="chapter" data-level="" data-path="chapter-5-generalized-linear-models.html"><a href="chapter-5-generalized-linear-models.html#two-part-or-hurdle-models"><i class="fa fa-check"></i>Two-Part or Hurdle Models</a></li>
<li class="chapter" data-level="" data-path="chapter-5-generalized-linear-models.html"><a href="chapter-5-generalized-linear-models.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5-generalized-linear-models.html"><a href="chapter-5-generalized-linear-models.html#beta-regression"><i class="fa fa-check"></i>Beta Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-6-multilevel-modeling.html"><a href="chapter-6-multilevel-modeling.html"><i class="fa fa-check"></i>Chapter 6: Multilevel Modeling</a><ul>
<li class="chapter" data-level="" data-path="chapter-6-multilevel-modeling.html"><a href="chapter-6-multilevel-modeling.html#gee"><i class="fa fa-check"></i>GEE</a></li>
<li class="chapter" data-level="" data-path="chapter-6-multilevel-modeling.html"><a href="chapter-6-multilevel-modeling.html#mixed-effects"><i class="fa fa-check"></i>Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="chapter-6-multilevel-modeling.html"><a href="chapter-6-multilevel-modeling.html#conclusions-1"><i class="fa fa-check"></i>Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-7-other-modeling-techniques.html"><a href="chapter-7-other-modeling-techniques.html"><i class="fa fa-check"></i>Chapter 7: Other Modeling Techniques</a><ul>
<li class="chapter" data-level="" data-path="chapter-7-other-modeling-techniques.html"><a href="chapter-7-other-modeling-techniques.html#mediation-modeling"><i class="fa fa-check"></i>Mediation Modeling</a></li>
<li class="chapter" data-level="" data-path="chapter-7-other-modeling-techniques.html"><a href="chapter-7-other-modeling-techniques.html#mixture-modeling"><i class="fa fa-check"></i>Mixture Modeling</a></li>
<li class="chapter" data-level="" data-path="chapter-7-other-modeling-techniques.html"><a href="chapter-7-other-modeling-techniques.html#structural-equation-modeling"><i class="fa fa-check"></i>Structural Equation Modeling</a></li>
<li class="chapter" data-level="" data-path="chapter-7-other-modeling-techniques.html"><a href="chapter-7-other-modeling-techniques.html#machine-learning-techniques"><i class="fa fa-check"></i>Machine Learning Techniques</a><ul>
<li class="chapter" data-level="" data-path="chapter-7-other-modeling-techniques.html"><a href="chapter-7-other-modeling-techniques.html#ridge-lasso-and-elastic-net"><i class="fa fa-check"></i>Ridge, Lasso and Elastic Net</a></li>
<li class="chapter" data-level="" data-path="chapter-7-other-modeling-techniques.html"><a href="chapter-7-other-modeling-techniques.html#random-forests"><i class="fa fa-check"></i>Random Forests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-8-advanced-data-manipulation.html"><a href="chapter-8-advanced-data-manipulation.html"><i class="fa fa-check"></i>Chapter 8: Advanced Data Manipulation</a><ul>
<li class="chapter" data-level="" data-path="chapter-8-advanced-data-manipulation.html"><a href="chapter-8-advanced-data-manipulation.html#your-own-functions"><i class="fa fa-check"></i>Your Own Functions</a></li>
<li class="chapter" data-level="" data-path="chapter-8-advanced-data-manipulation.html"><a href="chapter-8-advanced-data-manipulation.html#vectorized"><i class="fa fa-check"></i>Vectorized</a></li>
<li class="chapter" data-level="" data-path="chapter-8-advanced-data-manipulation.html"><a href="chapter-8-advanced-data-manipulation.html#for-loops"><i class="fa fa-check"></i>For Loops</a></li>
<li><a href="chapter-8-advanced-data-manipulation.html#the-apply-family">The <code>apply</code> family</a></li>
<li><a href="chapter-8-advanced-data-manipulation.html#the-purrr-package">The <code>purrr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-9-advanced-plotting.html"><a href="chapter-9-advanced-plotting.html"><i class="fa fa-check"></i>Chapter 9: Advanced Plotting</a><ul>
<li class="chapter" data-level="" data-path="chapter-9-advanced-plotting.html"><a href="chapter-9-advanced-plotting.html#types-of-plots"><i class="fa fa-check"></i>Types of Plots</a></li>
<li class="chapter" data-level="" data-path="chapter-9-advanced-plotting.html"><a href="chapter-9-advanced-plotting.html#color-schemes"><i class="fa fa-check"></i>Color Schemes</a></li>
<li class="chapter" data-level="" data-path="chapter-9-advanced-plotting.html"><a href="chapter-9-advanced-plotting.html#themes"><i class="fa fa-check"></i>Themes</a></li>
<li class="chapter" data-level="" data-path="chapter-9-advanced-plotting.html"><a href="chapter-9-advanced-plotting.html#labels-and-titles"><i class="fa fa-check"></i>Labels and Titles</a></li>
<li class="chapter" data-level="" data-path="chapter-9-advanced-plotting.html"><a href="chapter-9-advanced-plotting.html#facetting"><i class="fa fa-check"></i>Facetting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-10-where-to-go-from-here.html"><a href="chapter-10-where-to-go-from-here.html"><i class="fa fa-check"></i>Chapter 10: Where to go from here</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rstats for Researchers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-5-generalized-linear-models" class="section level1 unnumbered">
<h1>Chapter 5: Generalized Linear Models</h1>
<p>Generalized Linear Models (GLM’s) are extensions of linear regression to areas where assumptions of normality and homoskedasticity do not hold. There are several versions of GLM’s, each for different types and distributions of outcomes. We are going to go through several of the most common.</p>
<p>This chapter is to introduce the method very briefly and demonstrate how to perform one in <code>R</code>. We do not delve into the details of each method much, but rather focus on showing the quirks of the coding.</p>
<p>We discuss:</p>
<ol style="list-style-type: decimal">
<li>Logistic Regression</li>
<li>Poisson Regression</li>
<li>GLM with Gamma distribution</li>
<li>Negative binomial</li>
<li>Beta Regression</li>
</ol>
<div id="logistic-regression" class="section level2 unnumbered">
<h2>Logistic Regression</h2>
<p>For binary outcomes (e.g., yes or no, correct or incorrect, sick or healthy), logistic regression is a fantastic tool that provides useful and interpretable information. Much like simple and multiple linear regression, logistic regression<a href="#fn15" class="footnoteRef" id="fnref15"><sup>15</sup></a> uses dummy coding and provides coefficients that tell us the relationship between the outcome and the independent variables.</p>
<p>Since the outcome is binary, we use a statistical transformation to make things work well. This makes it so the outcome is in “log-odds.” A simple exponentiation of the coefficients and we get very useful “odds ratios.” These are very common in many fields using binary data.</p>
<p>Luckily, running a logistic regression is simple in <code>R</code>. We first create the binary outcome variable called <code>dep</code>. We use a new function called <code>mutate</code> to create a new variable (we could do this a number of ways but this is probably the cleanest way).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## First creating binary depression variable
df &lt;-<span class="st"> </span>df %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dep =</span> dpq010 +<span class="st"> </span>dpq020 +<span class="st"> </span>dpq030 +<span class="st"> </span>dpq040 +<span class="st"> </span>dpq050 +
<span class="st">               </span>dpq060 +<span class="st"> </span>dpq070 +<span class="st"> </span>dpq080 +<span class="st"> </span>dpq090) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dep2 =</span> <span class="kw">ifelse</span>(dep &gt;=<span class="st"> </span><span class="dv">10</span>, <span class="dv">1</span>,
                <span class="kw">ifelse</span>(dep &lt;<span class="st"> </span><span class="dv">10</span>, <span class="dv">0</span>, <span class="ot">NA</span>)))</code></pre></div>
<p>Note that we added the values from the ten variables that give us an overall depression score (<code>dep</code>). We then use <code>ifelse()</code> to create a binary version of depression called <code>dep2</code> with a cutoff of <span class="math inline">\(\geq 16\)</span> meaning depressed. Because there are missing values denoted as “NA” in this variable, we use a “nested ifelse” to say:</p>
<ol style="list-style-type: decimal">
<li>IF depression <span class="math inline">\(\geq 10\)</span> then dep2 is 1,</li>
<li>IF dpression <span class="math inline">\(&lt; 10\)</span>, then dep2 is 0,</li>
<li>ELSE dep2 is NA.</li>
</ol>
<p>Note that these nested <code>ifelse()</code> statements can be as long as you want. We further need to clean up the asthma and sedentary variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Fix some placeholders
df &lt;-<span class="st"> </span>df %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">asthma =</span> <span class="kw">washer</span>(mcq010, <span class="dv">9</span>),
         <span class="dt">asthma =</span> <span class="kw">washer</span>(asthma, <span class="dv">2</span>, <span class="dt">value =</span> <span class="dv">0</span>)) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sed =</span> <span class="kw">washer</span>(pad680, <span class="dv">9999</span>, <span class="dv">7777</span>))</code></pre></div>
<p>Now let’s run the logistic regression:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l_fit &lt;-<span class="st"> </span><span class="kw">glm</span>(dep2 ~<span class="st"> </span>asthma +<span class="st"> </span>sed +<span class="st"> </span>race +<span class="st"> </span>famsize,
             <span class="dt">data =</span> df,
             <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
<span class="kw">summary</span>(l_fit)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = dep2 ~ asthma + sed + race + famsize, family = &quot;binomial&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -0.781  -0.449  -0.408  -0.366   2.538  
## 
## Coefficients:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -2.616404   0.237915  -11.00  &lt; 2e-16 ***
## asthma             0.564068   0.127550    4.42  9.8e-06 ***
## sed                0.000569   0.000261    2.18   0.0291 *  
## raceOtherHispanic  0.711974   0.232854    3.06   0.0022 ** 
## raceWhite          0.127317   0.211625    0.60   0.5474    
## raceBlack          0.016217   0.220530    0.07   0.9414    
## raceOther         -0.464466   0.255621   -1.82   0.0692 .  
## famsize           -0.033267   0.037275   -0.89   0.3721    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2711.6  on 4440  degrees of freedom
## Residual deviance: 2654.9  on 4433  degrees of freedom
##   (1119 observations deleted due to missingness)
## AIC: 2671
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>We used <code>glm()</code> (stands for generalized linear model). The key to making it logistic, since you can use <code>glm()</code> for a linear model using maximum likelihood instead of <code>lm()</code> with least squares, is <code>family = &quot;binomial&quot;</code>. This tells <code>R</code> to do a logistic regression.</p>
</div>
<div id="poisson-regression" class="section level2 unnumbered">
<h2>Poisson Regression</h2>
<p>As we did in logistic regression, we will use the <code>glm()</code> function. The difference here is we will be using an outcome that is a count variable. For example, the sedentary variable (<code>sed</code>) that we have in <code>df</code> is a count of the minutes of sedentary activity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_fit &lt;-<span class="st"> </span><span class="kw">glm</span>(sed ~<span class="st"> </span>asthma +<span class="st"> </span>race +<span class="st"> </span>famsize,
             <span class="dt">data =</span> df,
             <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)
<span class="kw">summary</span>(p_fit)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = sed ~ asthma + race + famsize, family = &quot;poisson&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -27.40   -8.52   -1.54    6.01   36.95  
## 
## Coefficients:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        5.663256   0.003250  1742.5   &lt;2e-16 ***
## asthma             0.065090   0.001984    32.8   &lt;2e-16 ***
## raceOtherHispanic  0.128639   0.003711    34.7   &lt;2e-16 ***
## raceWhite          0.349709   0.003048   114.8   &lt;2e-16 ***
## raceBlack          0.334284   0.003134   106.7   &lt;2e-16 ***
## raceOther          0.340376   0.003279   103.8   &lt;2e-16 ***
## famsize           -0.023425   0.000501   -46.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 599886  on 5287  degrees of freedom
## Residual deviance: 573124  on 5281  degrees of freedom
##   (272 observations deleted due to missingness)
## AIC: 613079
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Sedentary may be over-dispersed (see plot) <img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /> and so other methods related to poisson may be necessary. For this book, we are not going to be delving into these in depth but we will introduce some below.</p>
<div id="gamma" class="section level3 unnumbered">
<h3>Gamma</h3>
<p>Regression with a gamma distribution are often found when analyzing costs in dollars. It is very similar to poisson but does not require integers and can handle more dispersion. However, the outcome must have values <span class="math inline">\(&gt; 0\)</span>. Just for demonstration:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Adjust sed
df$sed_gamma &lt;-<span class="st"> </span>df$sed +<span class="st"> </span>.<span class="dv">01</span>
g_fit &lt;-<span class="st"> </span><span class="kw">glm</span>(sed_gamma ~<span class="st"> </span>asthma +<span class="st"> </span>race +<span class="st"> </span>famsize,
             <span class="dt">data =</span> df,
             <span class="dt">family =</span> <span class="st">&quot;Gamma&quot;</span>)
<span class="kw">summary</span>(g_fit)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = sed_gamma ~ asthma + race + famsize, family = &quot;Gamma&quot;, 
##     data = df)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -4.355  -0.470  -0.078   0.304   1.683  
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        3.53e-03   1.04e-04   33.88  &lt; 2e-16 ***
## asthma            -1.70e-04   5.48e-05   -3.11  0.00188 ** 
## raceOtherHispanic -4.57e-04   1.20e-04   -3.81  0.00014 ***
## raceWhite         -1.10e-03   9.90e-05  -11.07  &lt; 2e-16 ***
## raceBlack         -1.06e-03   1.01e-04  -10.44  &lt; 2e-16 ***
## raceOther         -1.07e-03   1.05e-04  -10.25  &lt; 2e-16 ***
## famsize            6.38e-05   1.43e-05    4.45  8.8e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.298)
## 
##     Null deviance: 2030.7  on 5287  degrees of freedom
## Residual deviance: 1953.0  on 5281  degrees of freedom
##   (272 observations deleted due to missingness)
## AIC: 70512
## 
## Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="two-part-or-hurdle-models" class="section level3 unnumbered">
<h3>Two-Part or Hurdle Models</h3>
<p>We are going to use the <code>pscl</code> package to run a hurdle model. These models are built for situations where there is a count variable with many zeros (“zero-inflated”). The hurdle model makes slightly different assumptions regarding the zeros than the pure negative binomial that we present next. The hurdle consists of two models: one for whether the person had a zero or more (binomial) and if more than zero, how many (poisson).</p>
<p>To run a hurdle model, we are going to make a sedentary variable with many more zeros to illustrate and then we will run a hurdle model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Zero inflated sedentary (don&#39;t worry too much about the specifics)
df$sed_zero &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">100</span>, 
                             <span class="dt">size =</span> <span class="kw">length</span>(df$sed), 
                             <span class="dt">replace=</span><span class="ot">TRUE</span>) %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">20</span>:<span class="dv">25</span>), <span class="dv">0</span>, 
                      df$sed)
## Hurdle model
<span class="kw">library</span>(pscl)
h_fit =<span class="st"> </span><span class="kw">hurdle</span>(sed_zero ~<span class="st"> </span>asthma +<span class="st"> </span>race +<span class="st"> </span>famsize,
               <span class="dt">data =</span> df)
<span class="kw">summary</span>(h_fit)</code></pre></div>
<pre><code>## 
## Call:
## hurdle(formula = sed_zero ~ asthma + race + famsize, data = df)
## 
## Pearson residuals:
##    Min     1Q Median     3Q    Max 
## -3.541 -1.567 -0.231  1.290 10.025 
## 
## Count model coefficients (truncated poisson with log link):
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        5.678500   0.003380  1680.2   &lt;2e-16 ***
## asthma             0.046853   0.002117    22.1   &lt;2e-16 ***
## raceOtherHispanic  0.115828   0.003872    29.9   &lt;2e-16 ***
## raceWhite          0.338589   0.003166   107.0   &lt;2e-16 ***
## raceBlack          0.317691   0.003260    97.5   &lt;2e-16 ***
## raceOther          0.319385   0.003407    93.7   &lt;2e-16 ***
## famsize           -0.023442   0.000524   -44.7   &lt;2e-16 ***
## Zero hurdle model coefficients (binomial with logit link):
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         2.5283     0.2018   12.53   &lt;2e-16 ***
## asthma             -0.3118     0.1250   -2.49    0.013 *  
## raceOtherHispanic  -0.1642     0.2225   -0.74    0.461    
## raceWhite          -0.1557     0.1866   -0.83    0.404    
## raceBlack          -0.1410     0.1927   -0.73    0.464    
## raceOther           0.0562     0.2094    0.27    0.788    
## famsize            -0.0210     0.0331   -0.63    0.526    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Number of iterations in BFGS optimization: 12 
## Log-likelihood: -2.78e+05 on 14 Df</code></pre>
<p>Notice that the output has two parts: “Count model coefficients (truncated poisson with log link):” and “Zero hurdle model coefficients (binomial with logit link):”. Together they tell us about the relationship between the predictors and a count variable with many zeros.</p>
</div>
<div id="negative-binomial" class="section level3 unnumbered">
<h3>Negative Binomial</h3>
<p>Similar to that above, negative binomial is for zero-inflated count variables. It makes slightly different assumptions than the hurdle and doesn’t use a two-part approach. In order to run a negative binomial model we’ll use the <code>MASS</code> package and the <code>glm.nb()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
fit_nb &lt;-<span class="st"> </span><span class="kw">glm.nb</span>(sed_zero ~<span class="st"> </span>asthma +<span class="st"> </span>race +<span class="st"> </span>famsize,
                 <span class="dt">data =</span> df)
<span class="kw">summary</span>(fit_nb)</code></pre></div>
<p>Note that this model is not really appropriate because our data is somewhat contrived.</p>
</div>
</div>
<div id="beta-regression" class="section level2 unnumbered">
<h2>Beta Regression</h2>
<p>For outcomes that are bound between a lower and upper bound, Beta Regression is a great method. For example, if we are looking at test scores that are bound between 0 and 100. It is a very flexible method and allows for some extra analysis regarding the variation.</p>
<p>For this, we are going to use the <code>betareg</code> package. But first, we are going to reach a little and create a ficticiously bound variable in the data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Variable bound between 0 and 1
df$beta_var &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq</span>(.<span class="dv">05</span>, .<span class="dv">99</span>, <span class="dt">by =</span> .<span class="dv">01</span>), 
                      <span class="dt">size =</span> <span class="kw">length</span>(df$asthma),
                      <span class="dt">replace =</span> <span class="ot">TRUE</span>)
<span class="kw">library</span>(betareg)
fit_beta &lt;-<span class="st"> </span><span class="kw">betareg</span>(beta_var ~<span class="st"> </span>asthma +<span class="st"> </span>race +<span class="st"> </span>famsize,
                    <span class="dt">data =</span> df)
<span class="kw">summary</span>(fit_beta)</code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = beta_var ~ asthma + race + famsize, data = df)
## 
## Standardized weighted residuals 2:
##    Min     1Q Median     3Q    Max 
## -2.003 -0.702 -0.046  0.636  2.922 
## 
## Coefficients (mean model with logit link):
##                   Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)        0.12089    0.05779    2.09    0.036 *
## asthma            -0.02640    0.03897   -0.68    0.498  
## raceOtherHispanic -0.01321    0.06502   -0.20    0.839  
## raceWhite         -0.03372    0.05350   -0.63    0.528  
## raceBlack          0.00441    0.05539    0.08    0.937  
## raceOther         -0.02206    0.05873   -0.38    0.707  
## famsize           -0.00438    0.00982   -0.45    0.656  
## 
## Phi coefficients (precision model with identity link):
##       Estimate Std. Error z value Pr(&gt;|z|)    
## (phi)   2.4792     0.0413      60   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 93.6 on 8 Df
## Pseudo R-squared: 0.000358
## Number of iterations: 17 (BFGS) + 1 (Fisher scoring)</code></pre>
<p>The output provides coefficients and the “Phi” coefficients. Both are important parts of using beta regression but we are not going to discuss it here.</p>
<p>There are many resources available to learn more about beta regression and each of these GLM’s. As for now, we are going to move on to more complex modeling where there are clustering or repeated measures in the data.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="15">
<li id="fn15"><p>Technically, logistic regression is a linear regression model.<a href="chapter-5-generalized-linear-models.html#fnref15">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-4-basic-analyses.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-6-multilevel-modeling.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
